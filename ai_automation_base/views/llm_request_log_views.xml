<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- LLM Request Log List View -->
        <record id="view_llm_request_log_list" model="ir.ui.view">
            <field name="name">llm.request.log.list</field>
            <field name="model">llm.request.log</field>
            <field name="arch" type="xml">
                <list string="LLM Request Logs">
                    <field name="create_date"/>
                    <field name="provider_id"/>
                    <field name="user_id"/>
                    <field name="status"/>
                    <field name="request_type"/>
                    <field name="model_used"/>
                    <field name="total_tokens"/>
                    <field name="request_duration"/>
                    <field name="estimated_cost"/>
                </list>
            </field>
        </record>
        
        <!-- LLM Request Log Form View -->
        <record id="view_llm_request_log_form" model="ir.ui.view">
            <field name="name">llm.request.log.form</field>
            <field name="model">llm.request.log</field>
            <field name="arch" type="xml">
                <form string="LLM Request Log">
                    <header>
                        <button name="action_view_provider" string="View Provider" type="object" class="btn-secondary"/>
                        <button name="action_view_user" string="View User" type="object" class="btn-secondary"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="status" widget="badge" decoration-success="status == 'success'" decoration-danger="status == 'error'"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="provider_id"/>
                                <field name="user_id"/>
                                <field name="create_date"/>
                                <field name="request_type"/>
                                <field name="model_used"/>
                            </group>
                            <group>
                                <field name="input_tokens"/>
                                <field name="output_tokens"/>
                                <field name="total_tokens"/>
                                <field name="request_duration"/>
                                <field name="estimated_cost"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Request Data" name="request_data">
                                <field name="request_data" widget="ace" options="{'mode': 'json'}" readonly="1"/>
                            </page>
                            <page string="Response Data" name="response_data">
                                <field name="response_data" widget="ace" options="{'mode': 'json'}" readonly="1"/>
                            </page>
                            <page string="Error Details" name="error_details" invisible="status != 'error'">
                                <field name="error_message" readonly="1"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        
        <!-- LLM Request Log Search View -->
        <record id="view_llm_request_log_search" model="ir.ui.view">
            <field name="name">llm.request.log.search</field>
            <field name="model">llm.request.log</field>
            <field name="arch" type="xml">
                <search string="Search LLM Request Logs">
                    <field name="provider_id"/>
                    <field name="user_id"/>
                    <field name="model_used"/>
                    <field name="request_type"/>
                    <filter string="Success" name="success" domain="[('status', '=', 'success')]"/>
                    <filter string="Error" name="error" domain="[('status', '=', 'error')]"/>
                    <filter string="Timeout" name="timeout" domain="[('status', '=', 'timeout')]"/>
                    <filter string="Rate Limited" name="rate_limited" domain="[('status', '=', 'rate_limited')]"/>
                    <filter string="Today" name="today" domain="[('create_date', '>=', datetime.datetime.combine(context_today(), datetime.time(0,0,0)))]"/>
                    <filter string="This Week" name="this_week" domain="[('create_date', '>=', (context_today() - datetime.timedelta(days=7)).strftime('%Y-%m-%d'))]"/>
                    <filter string="This Month" name="this_month" domain="[('create_date', '>=', (context_today() - datetime.timedelta(days=30)).strftime('%Y-%m-%d'))]"/>
                    <group expand="0" string="Group By">
                        <filter string="Status" name="group_by_status" context="{'group_by': 'status'}"/>
                        <filter string="Provider" name="group_by_provider" context="{'group_by': 'provider_id'}"/>
                        <filter string="User" name="group_by_user" context="{'group_by': 'user_id'}"/>
                        <filter string="Request Type" name="group_by_type" context="{'group_by': 'request_type'}"/>
                        <filter string="Date" name="group_by_date" context="{'group_by': 'create_date:day'}"/>
                    </group>
                </search>
            </field>
        </record>
        
        <!-- LLM Request Log Action -->
        <record id="action_llm_request_log" model="ir.actions.act_window">
            <field name="name">LLM Request Logs</field>
            <field name="res_model">llm.request.log</field>
            <field name="view_mode">list,form</field>
            <field name="context">{}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    No request logs yet!
                </p>
                <p>
                    Request logs will appear here once you start using AI features.
                    They help monitor usage, costs, and troubleshoot issues.
                </p>
            </field>
        </record>
        
        <!-- LLM Request Log Menu -->
        <menuitem id="menu_llm_request_log"
                  name="Request Logs"
                  parent="menu_ai_automation_root"
                  action="action_llm_request_log"
                  sequence="40"/>
        
    </data>
</odoo> 